<!--pages/records/records.wxml-->
<view class="container theme-{{theme}}">
  <!-- å¤´éƒ¨åŒºåŸŸ -->
  <view class="header">
    <text class="title">æˆ‘çš„è®°å½•</text>
    <text class="subtitle" wx:if="{{totalRecords > 0}}">å…±{{totalRecords}}æ¡è®°å½•</text>
  </view>

  <!-- æ»šåŠ¨åŒºåŸŸ -->
  <scroll-view 
    class="scroll-area" 
    scroll-y 
    enhanced 
    show-scrollbar="{{false}}"
    bindscrolltolower="onLoadMore"
    lower-threshold="100"
  >
    <!-- è®°å½•åˆ—è¡¨ -->
    <view class="records-container" wx:if="{{recordsByDate.length > 0}}">
      <!-- æŒ‰æ—¥æœŸåˆ†ç»„ -->
      <view class="date-group" wx:for="{{recordsByDate}}" wx:key="date">
        <view class="date-label">
          <text class="date-text">{{item.dateLabel}}</text>
          <text class="date-count">{{item.records.length}}æ¡</text>
        </view>
        
        <!-- è¯¥æ—¥æœŸä¸‹çš„è®°å½• -->
        <view class="record-list">
          <view 
            class="record-card"
            wx:for="{{item.records}}"
            wx:for-item="record"
            wx:key="id"
          >
            <view class="record-main">
              <view class="record-header">
                <text class="emoji">{{record.icon}}</text>
                <text class="status-name">{{record.statusName}}</text>
              </view>
              
              <view class="record-time">
                <text class="time-text">{{record.startTimeStr}} - {{record.endTimeStr}}</text>
              </view>
              
              <view class="record-duration" wx:if="{{showDuration}}">
                <text class="duration-text">{{record.durationText}}</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{recordsByDate.length === 0 && !loading}}">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">è¿˜æ²¡æœ‰è®°å½•</text>
      <text class="empty-hint">å»é¦–é¡µè®¾ç½®ä¸€ä¸ªçŠ¶æ€å§</text>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more" wx:if="{{hasMore && recordsByDate.length > 0}}">
      <view class="loading-spinner small"></view>
      <text class="load-text">åŠ è½½ä¸­...</text>
    </view>

    <!-- æ²¡æœ‰æ›´å¤š -->
    <view class="no-more" wx:if="{{!hasMore && recordsByDate.length > 0}}">
      <text class="no-more-text">æ²¡æœ‰æ›´å¤šäº†</text>
    </view>

    <!-- åº•éƒ¨å®‰å…¨è·ç¦» -->
    <view class="bottom-safe-area"></view>
  </scroll-view>

  <!-- è‡ªå®šä¹‰ TabBar -->
  <tabbar current="1" bind:change="onTabChange"></tabbar>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-overlay" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view>
